# 智能合约

YAPE框架目前主要支持基于EVM虚拟机的智能合约执行环境，因此原则上开发者可以用Solidity、LLL等任意EVM上的智能合约编程语言来编写合约。YAPE框架除了优先支持流行的通用合约编程语言Solidity外，也支持博雅链面向金融监管应用场景的高安全编程语言RegLang。

## RegLang

区块链大量应用于金融场景中，这些场景对资产管理与追踪、实施监管限制、自动化监管与合规等有严格的功能性需求和高安全需求，Solidity等通用合约编程语言难以完全满足上述需求。RegLang编程语言是面向监管场景的领域特定编程语言，该语言具备很好的可交互性、可演算性和灵活性，能够支撑监管规则在区块链上的有效表达，有助于监管部门利用监管合约实现事中、实时、穿透式的监管。同时，该语言能够保证区块链事务的原子性，并且在满足监管需求的基础上保持简洁性，与业务合约编程语言低耦合，降低了监管专家编写合约的复杂度和工作量，并可以在交易凭证、审计追踪与反洗钱等方面取得更好的效果。

下面给出一个RegLang编写的监管合约的例子，这个监管合约可以对标准的ERC20代币合约进行监管。

例子中的前三行代码在black知识库中添加了一条知识blacklist，其他代码创建了一条规则CheckTransfer。在规则部分，第6行表示调用ERC20合约中transfer函数的事务会被检查;第7行是一条强制性规定，表示监管规则要求事务参数_value的值应不大于1000000；第8行是一条禁止性规定，表示如果事务的发起方或转账的接收方在黑名单中，事务就会被监管合约拒绝。

```bash
knowledgebase black
knowledge blacklist = ["0xBEeFbeefbEefbeEFbeEfbEEfBEeFbeEfBeEfBeef"];
end

rule CheckTransfer
reg contract(tx.to).name=="EIP20" and tx.function=="transfer":
	require tx.args._value<=1000000;
prohibit tx.from in knowledgebase(black).blacklist or tx.args._to in
	knowledgebase(black).blacklist;
end
```

RegLang编程语言的语法与开发手册请参考[RegLang语言开发手册](https://relang.boyanet.io)。
